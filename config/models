-- By default this file is used by `persistFileWith` in Model.hs (which is imported by Foundation.hs)
-- Syntax for this file here: https://github.com/yesodweb/persistent/blob/master/docs/Persistent-entity-syntax.md

User
    ident Text
    password Text Maybe
    role UserRole
    UniqueUser ident
    deriving Show Typeable
Email
    email Text
    userId UserId Maybe
    verkey Text Maybe
    UniqueEmail email
Comment json -- Adding "json" causes ToJSON and FromJSON instances to be derived.
    message Text
    userId UserId Maybe
    deriving Show Eq


-- FeeIncome
--     currency Currency
--     amountCents Int
--     walletTransactionReasonId WalletTransactionReasonId
--     time UTCTime
--     deriving Show


UserWallet
    userId UserId
    currency Currency
    amountCents Int
    walletId Text
    created UTCTime
    UniqueWallet userId currency
    deriving Show


WalletTransactionReason
    walletId UserWalletId
    deriving Show

WalletBalanceTransaction
    walletId UserWalletId
    type WalletTransactionType
    walletTransactionReasonId WalletTransactionReasonId
    amountCentsBefore Int
    time UTCTime
    deriving Show


DepositRequest
    currency Currency
    transferMethod TransferMethod
    centsAmount Int
    expectedFeeCents Int
    transactionCode Text
    targetCurrency Currency
    expectedConversionRatio Double
    created UTCTime
    userId UserId
    status DepositRequestStatus
    archived  Bool default=FALSE
    UniqueDepositRequest transactionCode
    deriving Show

AcceptedDeposit
    depositRequestId DepositRequestId
    currency Currency
    targetCurrency Currency
    centsRealIncome Int
    actualCoversionRatio Double
    centsActualFee Int
    walletId UserWalletId
    staffIdent Text
    staffId UserId Maybe
    accepted UTCTime
    walletTransactionReasonId WalletTransactionReasonId
    deriving Show

WithdrawalRequest
    walletId UserWalletId
    method TransferMethod
    addressee Text
    centsAmount Int
    created UTCTime
    walletTransactionReasonId WalletTransactionReasonId
    accepted UTCTime Maybe
    deriving Show

WithdrawalAccept
    requestId WithdrawalRequestId
    staffIdent Text
    staffId UserId Maybe
    deriving Show


-- ExchangeOrder
--     userId UserId
--     walletInId UserWalletId
--     walletOutId UserWalletId
--     currencyOut Currency
--     currencyIn  Currency
--     amountCents Int -- Cent actually taken (frozen) from user balance
--     ratio Double
--     expectedFeeCents Int
--     created UTCTime
--     status ExchangeOrderStatus
--     isActive Bool
--     walletTransactionReasonId WalletTransactionReasonId
--     deriving Show
--
-- ExchangeOrderExecution
--     orderId ExchangeOrderId
--     time UTCTime
--     outWalletTransactionReasonId WalletTransactionReasonId
--     inWalletTransactionReasonId WalletTransactionReasonId
--     fullyExecuted Bool default=FALSE
--     transferAmountCents Int
--     incomeAmountCents Int
--     feeCents Int
--     deriving Show

ExchangeOrder
    userId UserId
    pair ExchangePair
    amountCents Int
    amountLeft Int
    ratioNoramlization ExchangePair
    normalizedRatio Double
    expectedFeeCents Int
    created UTCTime
    status ExchangeOrderStatus
    isActive Bool
    walletTransactionReasonId WalletTransactionReasonId
    deriving Show Eq

ExchangeOrderExecution
    orderId ExchangeOrderId
    time UTCTime
    outWalletTransactionReasonId WalletTransactionReasonId
    inWalletTransactionReasonId WalletTransactionReasonId
    fullyExecuted Bool default=FALSE
    transferAmountCents Int
    incomeAmountCents Int
    feeCents Int
    deriving Show


InnerProfitRecord
    reasonId WalletTransactionReasonId
    currency Currency
    amountCents Int
    profitType ProfitType